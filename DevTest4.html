<script type="module">
  import { codeToHtml } from "https://esm.sh/shiki@1.0.0";

  class CodeNetDriven extends HTMLElement {
    constructor() {
      super();
      this.attachShadow({ mode: 'open' });
      
      this.shadowRoot.innerHTML = `
        <style>
          .code-container {
            padding: 20px;
            border-radius: 8px;
            background-color: #1e1e1e;
            border: 1px solid #333;
            margin: 20px 0;
          }
        </style>
        <div class="code-container">
          <div class="code-content"></div>
        </div>
      `;
    }

    async connectedCallback() {
      const code = this.innerHTML.trim();
      const language = this.getAttribute('codeFormat') || 'html';
      
      try {
        const highlightedCode = await codeToHtml(code, {
          lang: language,
          theme: 'min-dark'
        });
        
        this.shadowRoot.querySelector('.code-content').innerHTML = highlightedCode;
      } catch (error) {
        console.error('Error al resaltar el c√≥digo:', error);
      }
    }
  }

  customElements.define('code-net-driven', CodeNetDriven);
</script>